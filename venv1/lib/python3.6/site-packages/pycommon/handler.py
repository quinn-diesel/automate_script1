from pycommon.cases import snake_case_keys


def process_event(functions, event):

    field = event.get('field')
    if field not in functions:
        raise ValueError('Field value \'{}\' not supported'.format(field))

    identity = event.get('identity', {})

    args = snake_case_keys(event.get('arguments', {}))
    return functions[field](args, identity)
