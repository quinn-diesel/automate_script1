from .base import BaseApi, rex_result


class DedupeApi(BaseApi):

    @rex_result()
    def find_possible_duplicates(self, match_fields=None, raw=False):

        match_fields = ['name', 'email',
                        'phone'] if not match_fields else match_fields

        data = {
            'service_name': 'Contacts',
            'match_fields': match_fields,
            'company_or_person': 'person',
            'record_id': None,
        }

        return self.client.request('Dedupe::findPossibleDuplicates', data)

    @rex_result()
    def dedupe(self, winning_id, losing_ids, raw=False):
        data = {
            'service_name': 'Contacts',
            'winning_id': winning_id,
            'losing_ids': losing_ids,
        }

        return self.client.request('Dedupe::combineRecords', data)
